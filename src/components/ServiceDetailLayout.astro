---
/**
 * ServiceDetailLayout.astro
 * ã‚µãƒ¼ãƒ“ã‚¹è©³ç´°ãƒšãƒ¼ã‚¸ç”¨ã®å…±é€šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
 */
import Layout from '../layouts/Layout.astro';
import Breadcrumb from './seo/Breadcrumb.astro';
import StructuredData from './seo/StructuredData.astro';
import '../styles/service-detail.css';
import type { ServiceDetailData } from '@shared/contracts/components';

interface Props {
  data: ServiceDetailData;
}

const { data } = Astro.props;

import { siteMetadata } from '../lib/siteConfig';
const siteUrl = siteMetadata.siteUrl;

// ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
const breadcrumbItems = [
  { name: 'ã‚µãƒ¼ãƒ“ã‚¹', href: '/services/' },
  { name: data.name, href: `/services/${data.id}/` }
];

// Serviceæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿
const serviceSchemaData = {
  '@id': `${siteUrl}/services/${data.id}/#service`,
  name: data.name,
  description: data.metaDescription,
  url: `${siteUrl}/services/${data.id}/`,
  serviceType: data.name,
  offers: {
    '@type': 'Offer',
    priceSpecification: {
      '@type': 'PriceSpecification',
      price: data.priceRange,
      priceCurrency: 'JPY',
      unitText: data.priceUnit
    }
  }
};
---

<Layout
  title={`${data.name} | ã—ã—ã‚ƒã‚‚ï½œå‰å·æ˜Œå®`}
  description={data.metaDescription}
  currentPage="services"
>
  <!-- Service Structured Data -->
  <StructuredData type="Service" data={serviceSchemaData} slot="head" />
  <!-- Breadcrumb with structured data -->
  <div class="breadcrumb-wrapper">
    <Breadcrumb items={breadcrumbItems} separator="â€º" />
  </div>

  <!-- Service Hero -->
  <section class="service-hero">
    <div class="service-hero-inner">
      <div class="service-hero-icon">{data.icon}</div>
      <h1>{data.name}</h1>
      <p>{data.tagline}</p>
      <div class={`service-hero-price${data.originalPriceRange ? ' service-hero-price--discounted' : ''}`}>
        {data.originalPriceRange && <span class="original">{data.originalPriceRange}</span>}
        <span class="amount">{data.priceRange}</span>
        <span class="unit">{data.priceUnit}</span>
      </div>
      {data.discountReason && (
        <div class="service-hero-notice">
          <span aria-hidden="true">ğŸ“‹</span>
          <p>
            {data.discountReason}
            <br /><small>æ­£å¼ç™»éŒ²å¾Œã¯é€šå¸¸ä¾¡æ ¼ã«æ”¹å®šäºˆå®šã§ã™ã€‚</small>
          </p>
        </div>
      )}
      <div class="service-hero-cta">
        <a href="/contact/" class="btn-primary">ç„¡æ–™ç›¸è«‡ã™ã‚‹ â†’</a>
        <a href="/services/" class="btn-secondary">â† ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§</a>
      </div>
    </div>
  </section>

  <!-- Service Content -->
  <div class="service-content">
    <div class="service-content-inner">
      <!-- Problems -->
      <section class="content-section">
        <h2>ğŸ˜¥ ã“ã‚“ãªèª²é¡Œã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ</h2>
        <div class="problem-list">
          {data.problems.map((problem) => (
            <div class="problem-item">
              <p>{problem}</p>
            </div>
          ))}
        </div>
      </section>

      <!-- Features -->
      <section class="content-section">
        <h2>âœ¨ ã‚µãƒ¼ãƒ“ã‚¹ã®ç‰¹å¾´</h2>
        <div class="feature-grid">
          {data.features.map((feature) => (
            <div class="feature-card">
              <div class="feature-icon">{feature.icon}</div>
              <h3>{feature.title}</h3>
              <p>{feature.description}</p>
            </div>
          ))}
        </div>
      </section>

      <!-- Flow -->
      <section class="content-section">
        <h2>ğŸ“‹ æ”¯æ´ã®æµã‚Œ</h2>
        <div class="flow-list">
          {data.flow.map((step, index) => (
            <div class="flow-item" data-step={index + 1}>
              <h3>{step.title}</h3>
              <p>{step.description}</p>
            </div>
          ))}
        </div>
      </section>

      <!-- Pricing -->
      <section class="content-section">
        <h2>ğŸ’° æ–™é‡‘ãƒ—ãƒ©ãƒ³</h2>
        <div class="pricing-cards">
          {data.pricing.map((plan) => (
            <div class={`pricing-card${plan.popular ? ' popular' : ''}${plan.originalAmount ? ' discounted' : ''}`}>
              {plan.discountLabel && <span class="discount-badge">{plan.discountLabel}</span>}
              <div class="pricing-plan">{plan.plan}</div>
              {plan.originalAmount && <div class="pricing-original">{plan.originalAmount}<span>ä¸‡å††</span></div>}
              <div class="pricing-amount">{plan.amount}</div>
              <div class="pricing-unit">{plan.unit}</div>
              <p class="pricing-desc">{plan.description}</p>
            </div>
          ))}
        </div>
      </section>

      <!-- Related Services -->
      <section class="content-section">
        <h2>ğŸ”— é–¢é€£ã‚µãƒ¼ãƒ“ã‚¹</h2>
        <div class="related-grid">
          {data.relatedServices.map((service) => (
            <a href={service.href} class="related-card">
              <div class="related-card-icon">{service.icon}</div>
              <h3>{service.name}</h3>
              <p>{service.description}</p>
              <span class="related-link">è©³ã—ãè¦‹ã‚‹ â†’</span>
            </a>
          ))}
        </div>
      </section>
    </div>
  </div>

  <!-- CTA -->
  <section class="cta--dark">
    <h2>{data.cta.title}</h2>
    <p set:html={data.cta.description} />
    <a href="/contact/" class="btn-primary" data-track-cta="service-detail">ç„¡æ–™ç›¸è«‡ã™ã‚‹ â†’</a>
  </section>

</Layout>
