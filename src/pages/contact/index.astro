---
import Layout from '../../layouts/Layout.astro';
import FAQSection from '../../components/ui/FAQSection.astro';
import { externalAPIs } from '../../lib/siteConfig';
import '../../styles/forms.css';

const contactFAQ = [
  { question: 'ç›¸è«‡ã¯æœ¬å½“ã«ç„¡æ–™ã§ã™ã‹ï¼Ÿ', answer: 'ã¯ã„ã€åˆå›30åˆ†ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç›¸è«‡ã¯å®Œå…¨ç„¡æ–™ã§ã™ã€‚ã”å¥‘ç´„å‰ã«è²»ç”¨ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚' },
  { question: 'ã©ã‚“ãªè¦æ¨¡ã®ä¼šç¤¾ã§ã‚‚å¯¾å¿œã§ãã¾ã™ã‹ï¼Ÿ', answer: 'å€‹äººäº‹æ¥­ä¸»ã‹ã‚‰å¾“æ¥­å“¡100åç¨‹åº¦ã®ä¸­å°ä¼æ¥­ã¾ã§å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚å¤§ä¼æ¥­å‘ã‘ã®è¤‡é›‘ãªæ¡ˆä»¶ã¯ã€ä¿¡é ¼ã§ãã‚‹å°‚é–€å®¶ã‚’ã”ç´¹ä»‹ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚' },
  { question: 'ãƒªãƒ¢ãƒ¼ãƒˆã§ã®å¯¾å¿œã¯å¯èƒ½ã§ã™ã‹ï¼Ÿ', answer: 'ã‚‚ã¡ã‚ã‚“ã§ã™ã€‚Zoomã€Google Meetã€Microsoft Teamsãªã©ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚å…¨å›½ã©ã“ã‹ã‚‰ã§ã‚‚ã”ç›¸è«‡ã„ãŸã ã‘ã¾ã™ã€‚' },
  { question: 'ã¾ã ä½•ã‚’ç›¸è«‡ã™ã‚Œã°ã„ã„ã‹ã‚ã‹ã‚Šã¾ã›ã‚“', answer: 'ãã‚Œã§ã‚‚å¤§ä¸ˆå¤«ã§ã™ï¼ã€Œãªã‚“ã¨ãªãå›°ã£ã¦ã„ã‚‹ã€ã€Œã‚‚ã£ã¨è‰¯ããªã‚Šãã†ãªæ°—ãŒã™ã‚‹ã€ã¨ã„ã†æ®µéšã§ã‚‚ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚ä¸€ç·’ã«èª²é¡Œã‚’æ•´ç†ã™ã‚‹ã¨ã“ã‚ã‹ã‚‰å§‹ã‚ã‚‰ã‚Œã¾ã™ã€‚' },
];

const FORMSPREE_ENDPOINT = externalAPIs.formspreeEndpoint;
---

<Layout
  title="ãŠå•ã„åˆã‚ã› | ã—ã—ã‚ƒã‚‚ã‚«ãƒ³ãƒ‘ãƒ‹ãƒ¼"
  description="ã”ç›¸è«‡ãƒ»ãŠè¦‹ç©ã‚Šã¯ç„¡æ–™ã§ã™ã€‚DXæ¨é€²ãƒ»ç”ŸæˆAIå°å…¥ãƒ»ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ãƒ»çµŒå–¶æ”¯æ´ã«ã¤ã„ã¦ã€ãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„ã€‚"
  currentPage="contact"
>
  <section class="page-header">
    <div class="page-header-blob"></div>
    <h1>ãŠå•ã„åˆã‚ã›</h1>
    <p>ã”ç›¸è«‡ãƒ»ãŠè¦‹ç©ã‚Šã¯ç„¡æ–™ã§ã™ã€‚ãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„ã€‚</p>
  </section>

  <section class="contact-section">
    <div class="contact-inner">
      <div class="contact-form-card">
        <h2>ğŸ“¬ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹</h2>
        <p>ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
        <form action={FORMSPREE_ENDPOINT} method="POST" id="contactForm">
          <input type="hidden" name="_subject" value="ã€ã—ã—ã‚ƒã‚‚ã€‘ãŠå•ã„åˆã‚ã›">

          <div class="form-group">
            <label for="contact-name">
              ãŠåå‰<span class="required" aria-hidden="true">*</span>
              <span class="sr-only">ï¼ˆå¿…é ˆï¼‰</span>
            </label>
            <input type="text" id="contact-name" name="name" required aria-required="true" placeholder="å±±ç”° å¤ªéƒ">
          </div>

          <div class="form-group">
            <label for="contact-company">ä¼šç¤¾å</label>
            <input type="text" id="contact-company" name="company" placeholder="æ ªå¼ä¼šç¤¾ã€‡ã€‡">
          </div>

          <div class="form-group">
            <label for="contact-email">
              ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹<span class="required" aria-hidden="true">*</span>
              <span class="sr-only">ï¼ˆå¿…é ˆï¼‰</span>
            </label>
            <input type="email" id="contact-email" name="email" required aria-required="true" placeholder="example@company.com">
          </div>

          <div class="form-group">
            <label for="contact-phone">é›»è©±ç•ªå·</label>
            <input type="tel" id="contact-phone" name="phone" placeholder="03-1234-5678">
          </div>

          <div class="form-group">
            <label for="contact-category">
              ã”ç›¸è«‡å†…å®¹<span class="required" aria-hidden="true">*</span>
              <span class="sr-only">ï¼ˆå¿…é ˆï¼‰</span>
            </label>
            <select id="contact-category" name="category" required aria-required="true">
              <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
              <option value="dx">DXæ¨é€²ãƒ»ITæˆ¦ç•¥ã«ã¤ã„ã¦</option>
              <option value="ai">ç”ŸæˆAIå°å…¥ã«ã¤ã„ã¦</option>
              <option value="data">ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ã«ã¤ã„ã¦</option>
              <option value="management">çµŒå–¶æ”¯æ´ã«ã¤ã„ã¦</option>
              <option value="accounting">çµŒç†ãƒ»è¨˜å¸³ã«ã¤ã„ã¦</option>
              <option value="other">ãã®ä»–</option>
            </select>
          </div>

          <div class="form-group">
            <label for="contact-message">
              è©³ç´°<span class="required" aria-hidden="true">*</span>
              <span class="sr-only">ï¼ˆå¿…é ˆï¼‰</span>
            </label>
            <textarea id="contact-message" name="message" required aria-required="true" placeholder="ã”ç›¸è«‡å†…å®¹ã€ç¾åœ¨ã®èª²é¡Œã€ã”è¦æœ›ãªã©ã‚’ãŠæ›¸ããã ã•ã„"></textarea>
            <p class="form-note">ã€Œã“ã‚“ãªã“ã¨ç›¸è«‡ã—ã¦ã„ã„ã®ã‹ãªï¼Ÿã€ã‚‚å¤§æ­“è¿ã§ã™ï¼</p>
          </div>

          <div class="form-group">
            <div class="checkbox-group">
              <input type="checkbox" id="privacy" name="privacy" required>
              <label for="privacy"><a href="/privacy-policy/" target="_blank" rel="noopener noreferrer">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>ã«åŒæ„ã™ã‚‹</label>
            </div>
          </div>

          <button type="submit" class="btn-primary">é€ä¿¡ã™ã‚‹ â†’</button>
        </form>
        <script>
          import { trackFormSubmit, initFormAbandonmentTracking } from '../../lib/analytics';
          const form = document.getElementById('contactForm') as HTMLFormElement | null;
          form?.addEventListener('submit', async (e) => {
            e.preventDefault();
            trackFormSubmit({ form_type: 'contact' });
            const btn = form.querySelector('button[type="submit"]') as HTMLButtonElement;
            if (btn) { btn.disabled = true; btn.textContent = 'é€ä¿¡ä¸­...'; }
            try {
              const res = await fetch(form.action, {
                method: 'POST',
                body: new FormData(form),
                headers: { 'Accept': 'application/json' },
              });
              if (res.ok) {
                window.location.href = '/contact/thanks/';
              } else {
                alert('é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
                if (btn) { btn.disabled = false; btn.textContent = 'é€ä¿¡ã™ã‚‹ â†’'; }
              }
            } catch {
              alert('é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
              if (btn) { btn.disabled = false; btn.textContent = 'é€ä¿¡ã™ã‚‹ â†’'; }
            }
          });
          initFormAbandonmentTracking('contactForm', 'contact');
        </script>
      </div>

      <div class="contact-sidebar">
        <div class="sidebar-card response-card">
          <h3>âš¡ è¿”ä¿¡ç›®å®‰</h3>
          <div class="response-time">24æ™‚é–“ä»¥å†…</div>
          <p>å–¶æ¥­æ—¥ä»¥å†…ã«å¿…ãšã”è¿”ä¿¡ã—ã¾ã™</p>
        </div>

        <div class="sidebar-card">
          <h3>ğŸ’¬ åˆå›ç›¸è«‡ç„¡æ–™</h3>
          <p>30åˆ†ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç›¸è«‡ã§ã€å¾¡ç¤¾ã®èª²é¡Œã‚’æ•´ç†ã—ã¾ã™ã€‚</p>
          <ul>
            <li>èª²é¡Œã®ãƒ’ã‚¢ãƒªãƒ³ã‚°</li>
            <li>è§£æ±ºã®æ–¹å‘æ€§ã®ã”ææ¡ˆ</li>
            <li>ãŠè¦‹ç©ã‚Šã®æ¦‚ç®—</li>
          </ul>
        </div>

        <div class="sidebar-card">
          <h3>ğŸ“ å¯¾å¿œã‚¨ãƒªã‚¢</h3>
          <p>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¯¾å¿œã®ãŸã‚å…¨å›½OKã€‚å¯¾é¢ã‚’ã”å¸Œæœ›ã®å ´åˆã¯é–¢æ±åœã§èª¿æ•´å¯èƒ½ã§ã™ã€‚</p>
        </div>

        <div class="sidebar-card">
          <h3>ğŸ”’ æƒ…å ±ç®¡ç†</h3>
          <p>ãŠé ã‹ã‚Šã—ãŸæƒ…å ±ã¯é©åˆ‡ã«ç®¡ç†ã—ã€ã”ç›¸è«‡å¯¾å¿œä»¥å¤–ã®ç›®çš„ã«ã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚</p>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <FAQSection title="ã‚ˆãã‚ã‚‹ã”è³ªå•" items={contactFAQ} generateSchema />
</Layout>

<style>
  /* Contact Section */
  .contact-section { padding: 4rem 2rem 5rem; position: relative; }
  .contact-inner {
    max-width: 1000px; margin: 0 auto;
    display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 3rem; position: relative;
  }

  /* Form Card */
  .contact-form-card {
    background: var(--white); border-radius: var(--radius-lg); padding: 2.5rem;
    box-shadow: var(--shadow-xl);
  }
  .contact-form-card h2 { font-family: var(--font-display); font-size: 1.5rem; margin-bottom: 0.5rem; }
  .contact-form-card > p { color: var(--gray); font-size: 0.95rem; margin-bottom: 2rem; }

  .contact-form-card .btn-primary { width: 100%; justify-content: center; }

  /* Sidebar */
  .contact-sidebar { display: flex; flex-direction: column; gap: 1.5rem; }
  .sidebar-card {
    background: var(--white); border-radius: var(--radius-md); padding: 1.5rem;
    border: 2px solid var(--gray-light); transition: all 0.3s;
  }
  .sidebar-card:hover { border-color: var(--primary); }
  .sidebar-card h3 { font-size: 1rem; font-weight: 700; margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem; }
  .sidebar-card p { font-size: 0.9rem; color: var(--gray); line-height: 1.7; }
  .sidebar-card ul { margin-top: 0.75rem; }
  .sidebar-card li {
    font-size: 0.85rem; color: var(--gray); padding: 0.25rem 0;
    padding-left: 1.25rem; position: relative;
  }
  .sidebar-card li::before { content: 'âœ“'; position: absolute; left: 0; color: var(--accent); }

  .response-card {
    background: var(--success);
    color: #1e293b; border: none; position: relative; overflow: hidden;
  }
  .response-card::before {
    content: 'âš¡'; position: absolute; right: 10px; top: 10px;
    font-size: 4rem; opacity: 0.15;
  }
  .response-card h3 { color: #1e293b; }
  .response-time { font-family: var(--font-display); font-size: 2rem; font-weight: 700; margin: 0.5rem 0; }
  .response-card p { color: rgba(30, 41, 59, 0.85); }

  /* ===== DARK MODE ===== */
  :global([data-theme="dark"]) .contact-section { background: var(--gray-50); }
  :global([data-theme="dark"]) .contact-form-card {
    background: var(--gray-100);
    box-shadow: var(--shadow-lg);
  }
  :global([data-theme="dark"]) .contact-form-card > p { color: var(--gray-600); }
  :global([data-theme="dark"]) .sidebar-card {
    background: var(--gray-100);
    border-color: var(--gray-300);
  }
  :global([data-theme="dark"]) .sidebar-card p,
  :global([data-theme="dark"]) .sidebar-card li { color: var(--gray-600); }
  :global([data-theme="dark"]) .response-card {
    background: var(--success-dark);
    color: #1e293b;
  }
  :global([data-theme="dark"]) .response-card h3 { color: #1e293b; }
  /* Responsive */
  @media (max-width: 768px) {
    .contact-section { padding: 3rem 1.5rem; }
    .contact-inner { grid-template-columns: 1fr; gap: 2rem; }
    .contact-sidebar { order: -1; flex-direction: row; flex-wrap: wrap; }
    .sidebar-card { flex: 1; min-width: 200px; }
    .contact-form-card { padding: 2rem 1.5rem; }
    .contact-form-card h2 { font-size: 1.35rem; }
  }

  @media (max-width: 480px) {
    .contact-section { padding: 2rem 1rem; }
    .contact-sidebar { flex-direction: column; }
    .sidebar-card { min-width: auto; }
    .contact-form-card { padding: 1.5rem 1rem; }
  }
</style>
